<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" type="image/png" href="/img/favicon.ico">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#705a98">
  <meta name="description" content="">
  <meta name="author" content="XuYuTong">
  <meta name="keywords" content="">
  <title>ä» Promises/A+ è§„èŒƒç…ä¸€ç… Promise - èŠ‹å¤´&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->

  
<link rel="stylesheet" href="/css/iconfont/iconfont.css">



  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>èŠ‹å¤´'s Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2020-06-20 10:00">
      2020å¹´6æœˆ20æ—¥ ä¸Šåˆ
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.5k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      85
       åˆ†é’Ÿ
    </span>
  

  
  
    
      <!-- ä¸è’œå­ç»Ÿè®¡æ–‡ç« PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> æ¬¡
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <blockquote>
<p>å…ˆè¿›è¡Œä¸€äº›åŸºæœ¬çš„æ¦‚å¿µæ¢³ç†ï¼š</p>
</blockquote>
<h3 id="ä»€ä¹ˆæ˜¯-Promiseï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Promiseï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Promiseï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Promiseï¼Ÿ</h3><p><code>Promise</code> æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼šä»è¯­æ³•ä¸Šè®²ï¼Œ<code>Promise</code>æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ï¼›ä»æœ¬æ„ä¸Šè®²ï¼Œå®ƒæ˜¯æ‰¿è¯ºï¼Œæ‰¿è¯ºå®ƒè¿‡ä¸€æ®µæ—¶é—´ä¼šç»™ä½ ä¸€ä¸ªç»“æœã€‚</p>
<h3 id="Promise-å¯ä»¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#Promise-å¯ä»¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="Promise å¯ä»¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>Promise å¯ä»¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h3><ul>
<li><strong>å›è°ƒåœ°ç‹±</strong>ï¼Œä»£ç éš¾ä»¥ç»´æŠ¤ï¼Œ å¸¸å¸¸ç¬¬ä¸€ä¸ªçš„å‡½æ•°çš„è¾“å‡ºæ˜¯ç¬¬äºŒä¸ªå‡½æ•°çš„è¾“å…¥è¿™ç§ç°è±¡</li>
</ul>
<p>å½“å¼‚æ­¥åœºæ™¯è¶Šæ¥è¶Šå¤šçš„æ—¶å€™ï¼Œä»£ç ä¼šæ¨ªå‘å‘å±•ï¼ˆå˜å®½ï¼‰ï¼Œä¾èµ–çš„å±‚çº§é€æ¸å˜å¤šï¼Œä¼šä¸åœçš„è¿›è¡ŒåµŒå¥— ï¼Œæœ€ç»ˆå¯¼è‡´å›è°ƒåœ°ç‹±ã€‚<code>Promise</code>å®é™…ä¸Šæ˜¯ä½¿å¼‚æ­¥è°ƒç”¨æ›´åŠ é“¾å¼äº†ï¼Œå¯ä»¥å°†å¼‚æ­¥æ“ä½œé˜Ÿåˆ—åŒ–ï¼ŒæŒ‰ç…§æœŸæœ›çš„é¡ºåºä¾æ¬¡è¿›è¡Œæ‰§è¡Œï¼Œè¿”å›ç¬¦åˆé¢„æœŸçš„ç»“æœã€‚</p>
<ul>
<li><code>Promise</code>å¯ä»¥æ”¯æŒå¤šä¸ªå¹¶å‘çš„è¯·æ±‚ï¼Œè·å–å¹¶å‘è¯·æ±‚ä¸­çš„æ•°æ®</li>
<li><code>Promise</code>å¯ä»¥è§£å†³å¼‚æ­¥çš„é—®é¢˜ï¼Œä½†æœ¬èº«ä¸èƒ½è¯´ promise æ˜¯å¼‚æ­¥çš„</li>
</ul>
<h4 id="ä¸¾ä¸ª-ğŸŒ°"><a href="#ä¸¾ä¸ª-ğŸŒ°" class="headerlink" title="ä¸¾ä¸ª ğŸŒ°"></a>ä¸¾ä¸ª ğŸŒ°</h4><pre><code class="hljs javascript"><span class="hljs-comment">//å›è°ƒå‡½æ•°</span>
<span class="hljs-keyword">const</span> callback=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'callback'</span>)
&#125;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callbackFn</span>(<span class="hljs-params">fn</span>)</span>&#123;
    setTimeout(fn,<span class="hljs-number">3000</span>)
&#125;
callbackFn(callback)
<span class="hljs-comment">//å°è£…æˆpromise</span>
<span class="hljs-keyword">const</span> promise =<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolve,reject</span>)</span>&#123;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'success'</span>)
    resolve()
&#125;)
promise.then(
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;
        setTimeout(callback,<span class="hljs-number">3000</span>)
    &#125;
)</code></pre>


<h3 id="Promise-ä¼˜ç¼ºç‚¹"><a href="#Promise-ä¼˜ç¼ºç‚¹" class="headerlink" title="Promise ä¼˜ç¼ºç‚¹"></a>Promise ä¼˜ç¼ºç‚¹</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul>
<li>æŠŠæ‰§è¡Œä»£ç å’Œå¤„ç†ä»£ç åˆ†ç¦»å¼€ï¼Œä½¿å¼‚æ­¥æ“ä½œé€»è¾‘æ›´åŠ æ¸…æ™°ã€‚</li>
<li>å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°(å¹¶æœªå‰¥å¤ºå‡½æ•°<code>return</code>çš„èƒ½åŠ›ï¼Œå› æ­¤æ— éœ€å±‚å±‚ä¼ é€’<code>callback</code>ï¼Œè¿›è¡Œå›è°ƒè·å–æ•°æ®)</li>
<li>å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“</li>
<li>ä»£ç é£æ ¼ï¼Œå®¹æ˜“ç†è§£ï¼Œä¾¿äºç»´æŠ¤</li>
</ul>
<h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><ul>
<li>æ— æ³•å–æ¶ˆ <code>Promise</code>ï¼Œä¸€æ—¦æ–°å»ºå®ƒå°±ä¼šç«‹å³æ‰§è¡Œï¼Œæ— æ³•ä¸­é€”å–æ¶ˆ</li>
<li>å¦‚æœä¸è®¾ç½®å›è°ƒå‡½æ•°ï¼Œ<code>Promise</code>å†…éƒ¨æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸ä¼šååº”åˆ°å¤–éƒ¨</li>
<li>å½“å¤„äº<code>Pending</code>çŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µ</li>
</ul>
<h3 id="Promise-ä¸‰ç§çŠ¶æ€"><a href="#Promise-ä¸‰ç§çŠ¶æ€" class="headerlink" title="Promise ä¸‰ç§çŠ¶æ€"></a>Promise ä¸‰ç§çŠ¶æ€</h3><ul>
<li>åˆå§‹çŠ¶æ€ï¼š<code>pending</code>(ç­‰å¾…æ€)</li>
<li>æ“ä½œæˆåŠŸï¼š<code>fulfilled</code>(æˆåŠŸæ€)</li>
<li>æ“ä½œå¤±è´¥ï¼š<code>rejected</code>(å¤±è´¥æ€)</li>
</ul>
<h3 id="Promise-ä½¿ç”¨"><a href="#Promise-ä½¿ç”¨" class="headerlink" title="Promise ä½¿ç”¨"></a>Promise ä½¿ç”¨</h3><p><code>Promise</code>çš„æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªå‡½æ•°éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><code>resolve()</code>: å¼‚æ­¥æ“ä½œæ‰§è¡ŒæˆåŠŸåçš„å›è°ƒå‡½æ•°,å°†<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œæˆåŠŸâ€ï¼ˆå³ä» <code>pending</code> å˜ä¸º <code>resolved</code>ï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ï¼›</li>
<li><code>reject()</code>: å¼‚æ­¥æ“ä½œæ‰§è¡Œå¤±è´¥åçš„å›è°ƒå‡½æ•°,å°†<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œå¤±è´¥â€ï¼ˆå³ä» <code>pending</code> å˜ä¸º <code>rejected</code>ï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚åœ¨æ‰§è¡Œ<code>resolve</code>çš„å›è°ƒæ—¶ï¼Œå¦‚æœæŠ›å‡ºå¼‚å¸¸äº†ï¼ˆä»£ç å‡ºé”™äº†ï¼‰ï¼Œé‚£ä¹ˆå¹¶ä¸ä¼šæŠ¥é”™å¡æ­»<code>js</code>ï¼Œè€Œæ˜¯ä¼šè¿›åˆ°è¿™ä¸ª<code>catch</code>æ–¹æ³•ä¸­ã€‚</li>
<li>å½“<code>Promise</code>çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¼šè§¦å‘<code>then()</code>é‡Œçš„å“åº”å‡½æ•°å¤„ç†åç»­æ­¥éª¤ï¼›åˆ›é€ <code>Promise</code>å®ä¾‹åï¼Œå®ƒä¼šç«‹å³æ‰§è¡Œï¼Œ<code>Promise</code>çŠ¶æ€ä¸€ç»æ”¹å˜ï¼Œä¸ä¼šå†å˜ã€‚</li>
<li>å½“å‡ºç°<code>.then()</code>é‡Œé¢æœ‰<code>.then()</code>çš„æƒ…å†µæ—¶ï¼Œç”±äº<code>.then()</code>è¿”å›çš„è¿˜æ˜¯ Promise å®ä¾‹ï¼Œä¼šç­‰é‡Œé¢çš„<code>.then()</code>æ‰§è¡Œå®Œï¼Œå†æ‰§è¡Œå¤–é¢çš„</li>
</ul>
<pre><code class="hljs javascript"><span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;
        <span class="hljs-comment">//åšä¸€äº›å¼‚æ­¥æ“ä½œ</span>
      setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;
            <span class="hljs-keyword">var</span> num = <span class="hljs-built_in">Math</span>.ceil(<span class="hljs-built_in">Math</span>.random()*<span class="hljs-number">10</span>); <span class="hljs-comment">//ç”Ÿæˆ1-10çš„éšæœºæ•°</span>
            <span class="hljs-keyword">if</span>(num&lt;=<span class="hljs-number">5</span>)&#123;
                resolve(num);
            &#125;
            <span class="hljs-keyword">else</span>&#123;
                reject(<span class="hljs-string">'æ•°å­—å¤ªå¤§äº†'</span>);
            &#125;
      &#125;, <span class="hljs-number">2000</span>);
    &#125;);
    p.then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'resolved'</span>,data);
        &#125;,(err) =&gt; &#123;
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'rejected'</span>,err);
        &#125;
    );</code></pre>


<h3 id="Promises-A-è§„èŒƒï¼ˆåˆ’é‡ç‚¹ï¼‰"><a href="#Promises-A-è§„èŒƒï¼ˆåˆ’é‡ç‚¹ï¼‰" class="headerlink" title="Promises/A+ è§„èŒƒï¼ˆåˆ’é‡ç‚¹ï¼‰*"></a>Promises/A+ è§„èŒƒï¼ˆåˆ’é‡ç‚¹ï¼‰*</h3><p>å…¶å®å½’æ ¹ç»“åº•ï¼Œ<code>Promises/A+</code> è§„èŒƒä¸ºæ•´ä¸ª<code>Promise</code>çš„æ‰§è¡Œå’Œä½¿ç”¨æä¾›äº†å®Œæ•´çš„è§£é‡Šï¼Œæ‰€æœ‰å¯¹<code>Promise</code>çš„ç–‘é—®éƒ½èƒ½åœ¨è¿™é‡Œå¾—åˆ°è§£ç­”ã€‚</p>
<p>å…ˆä¸Šä¸€ä¸ªå®˜æ–¹åœ°å€ï¼š<a href="https://promisesaplus.com/" target="_blank" rel="noopener">https://promisesaplus.com</a></p>
<blockquote>
<p>ç”±äºå®˜ç½‘æ˜¯è‹±æ–‡ç‰ˆæœ¬ï¼Œä¸ºäº†ä¾¿äºé˜…è¯»å’Œç†è§£ï¼Œç»“åˆ Google ç¿»è¯‘è‡ªå·±è½¬è¯‘äº†ä¸€ä¸‹ï¼Œæ°´å¹³æœ‰é™ï¼Œæœ‰é—®é¢˜æ¬¢è¿æŒ‡æ­£ï¼Œæ„Ÿæ©çš„å¿ƒ ğŸ’—ğŸ’—</p>
</blockquote>
<h4 id="è§„èŒƒæ­£æ–‡ï¼šï¼ˆä¸¾-ğŸŒ°-è¡¥å……ï¼‰"><a href="#è§„èŒƒæ­£æ–‡ï¼šï¼ˆä¸¾-ğŸŒ°-è¡¥å……ï¼‰" class="headerlink" title="è§„èŒƒæ­£æ–‡ï¼šï¼ˆä¸¾ ğŸŒ° è¡¥å……ï¼‰"></a>è§„èŒƒæ­£æ–‡ï¼šï¼ˆä¸¾ ğŸŒ° è¡¥å……ï¼‰</h4><pre><code>**ä¸€ä¸ªç”±å®æ–½è€…æä¾›çš„å¼€æ”¾çš„ï¼Œå¯å®ç°çš„ï¼Œå¯äº’æ“ä½œçš„ JavaScript æ‰¿è¯ºçš„æ ‡å‡†ï¼Œå¯¹äºå®æ–½è€…ã€‚**


ä¸€ä¸ª`Promise`è¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆç»“æœã€‚ä¸æ‰¿è¯ºè¿›è¡Œäº¤äº’çš„ä¸»è¦æ–¹å¼æ˜¯é€šè¿‡å…¶`then`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ³¨å†Œå›è°ƒä»¥æ¥æ”¶æ‰¿è¯ºçš„æœ€ç»ˆå€¼æˆ–æ— æ³•å®ç°æ‰¿è¯ºçš„åŸå› ã€‚


è¯¥è§„èŒƒè¯¦ç»†ä»‹ç»äº†è¯¥`then`æ–¹æ³•çš„è¡Œä¸ºï¼Œæä¾›äº†å¯äº’æ“ä½œçš„åŸºç¡€ï¼Œæ‰€æœ‰`Promises / A +`å…¼å®¹çš„`Promise`å®ç°éƒ½å¯ä»¥ä¾é è¯¥åŸºç¡€æ¥æä¾›ã€‚å› æ­¤ï¼Œè¯¥è§„èŒƒåº”è¢«è®¤ä¸ºæ˜¯éå¸¸ç¨³å®šçš„ã€‚å°½ç®¡ Promises / A +ç»„ç»‡æœ‰æ—¶ä¼šé€šè¿‡å‘åå…¼å®¹çš„å¾®å°æ›´æ”¹æ¥ä¿®è®¢æ­¤è§„èŒƒï¼Œä»¥è§£å†³æ–°å‘ç°çš„æç«¯æƒ…å†µï¼Œä½†åªæœ‰ç»è¿‡ä»”ç»†è€ƒè™‘ï¼Œè®¨è®ºå’Œæµ‹è¯•ä¹‹åï¼Œæˆ‘ä»¬æ‰ä¼šé›†æˆå¤§å‹æˆ–å‘åå…¼å®¹çš„æ›´æ”¹ã€‚


ä»å†å²ä¸Šçœ‹ï¼Œ`Promises / A +`é˜æ˜äº†è¾ƒæ—©çš„`Promises / A`ææ¡ˆçš„è¡Œä¸ºæ¡æ¬¾ï¼Œå°†å…¶æ‰©å±•ä¸ºæ¶µç›–äº‹å®ä¸Šçš„è¡Œä¸ºï¼Œå¹¶çœç•¥äº†æœªæŒ‡å®šæˆ–æœ‰é—®é¢˜çš„éƒ¨åˆ†ã€‚


æœ€åï¼Œæ ¸å¿ƒçš„`Promises / A +`è§„èŒƒä¸æ¶‰åŠå¦‚ä½•åˆ›å»ºï¼Œå±¥è¡Œæˆ–æ‹’ç»è¯ºè¨€ï¼Œè€Œæ˜¯ä¸“æ³¨äºæä¾›ä¸€ç§å¯äº’æ“ä½œçš„`then`æ–¹æ³•ã€‚æœªæ¥å·¥ä½œä¸­ä¼´éšç€è¿™äº›è§„èŒƒå¯èƒ½æ¶‰åŠåˆ°è¿™äº›ä¸»é¢˜ã€‚</code></pre><h5 id="æœ¯è¯­"><a href="#æœ¯è¯­" class="headerlink" title="æœ¯è¯­"></a>æœ¯è¯­</h5><ul>
<li><code>Promise</code>æ˜¯å…·æœ‰ then æ–¹æ³•çš„ç¬¦åˆæœ¬è§„èŒƒçš„å¯¹è±¡æˆ–å‡½æ•°ã€‚ï¼ˆ<strong>ç‹­ä¹‰è®¤ä¸ºä¸€ä¸ªå¯¹è±¡åªè¦æœ‰ then æ–¹æ³•å°±æ˜¯ä¸€ä¸ªåˆæ³•çš„ promise å¯¹è±¡ï¼‰</strong></li>
<li><code>thenable</code>ï¼ˆåŒ…å«<code>then</code>æ–¹æ³•ï¼‰æ˜¯å®šä¹‰<code>then</code>æ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°ã€‚</li>
<li><code>valueï¼ˆå€¼ï¼‰</code>æ˜¯ä»»ä½•åˆæ³•çš„<code>JavaScript</code>å€¼ï¼ˆåŒ…æ‹¬<code>undefined</code>ï¼Œ<code>thenable</code>æˆ–<code>promise</code>ï¼‰ã€‚</li>
<li><code>exceptionï¼ˆå¼‚å¸¸ï¼‰</code>æ˜¯ä½¿ç”¨è¯¥ throw è¯­å¥å¼•å‘çš„å€¼ã€‚</li>
<li><code>reasonï¼ˆåŸå› ï¼‰</code>æ˜¯è¡¨æ˜æ‹’ç»æ‰¿è¯ºçš„åŸå› çš„å€¼ã€‚</li>
</ul>
<h5 id="è¦æ±‚"><a href="#è¦æ±‚" class="headerlink" title="è¦æ±‚"></a>è¦æ±‚</h5><h5 id="promise-çš„çŠ¶æ€"><a href="#promise-çš„çŠ¶æ€" class="headerlink" title="promise çš„çŠ¶æ€"></a>promise çš„çŠ¶æ€</h5><p>ä¸€ä¸ª<code>promise</code>å¿…é¡»å¤„äºä»¥ä¸‹ä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼šç­‰å¾…ä¸­ï¼ˆ<code>pending</code>ï¼‰ï¼Œå·²å®Œæˆï¼ˆ<code>fulfilled</code>ï¼‰æˆ–å·²æ‹’ç»ï¼ˆ<code>rejected</code>ï¼‰ã€‚</p>
<ul>
<li>å¤„äºç­‰å¾…ä¸­ï¼š<ul>
<li>å¯èƒ½ä¼šè½¬æ¢ä¸ºå·²å®Œæˆæˆ–å·²æ‹’ç»çŠ¶æ€ã€‚</li>
</ul>
</li>
<li>å½“å·²å®Œæˆæ—¶ï¼š<ul>
<li>ä¸å¾—è¿‡æ¸¡åˆ°ä»»ä½•å…¶ä»–çŠ¶æ€ã€‚</li>
<li>å¿…é¡»å…·æœ‰ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼ä¸èƒ½æ›´æ”¹ã€‚</li>
</ul>
</li>
<li>å½“å·²æ‹’ç»æ—¶ï¼š<ul>
<li>ä¸å¾—è¿‡æ¸¡åˆ°ä»»ä½•å…¶ä»–çŠ¶æ€ã€‚</li>
<li>å¿…é¡»æœ‰ä¸€ä¸ªåŸå› ï¼Œä¸èƒ½æ”¹å˜ã€‚</li>
</ul>
</li>
</ul>
<p>åœ¨æ­¤ï¼Œâ€œä¸å¾—æ›´æ”¹â€æ˜¯æŒ‡ä¸å˜çš„èº«ä»½ï¼ˆå³===ï¼‰ï¼Œä½†å¹¶ä¸è¡¨ç¤ºæ·±å±‚çš„ä¸å˜æ€§ã€‚</p>
<h5 id="ä¸€ä¸ª-then-æ–¹æ³•"><a href="#ä¸€ä¸ª-then-æ–¹æ³•" class="headerlink" title="ä¸€ä¸ª then æ–¹æ³•"></a>ä¸€ä¸ª then æ–¹æ³•</h5><p>ä¸€ä¸ªæ‰¿è¯ºå¿…é¡»æä¾›ä¸€ä¸ª<code>then</code>æ–¹æ³•æ¥è®¿é—®å…¶å½“å‰æˆ–æœ€ç»ˆå€¼æˆ–åŸå› ã€‚</p>
<p><code>Promise</code>çš„<code>then</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p>
<blockquote>
<p>promise.then(onFulfilled, onRejected)</p>
</blockquote>
<ul>
<li><p>è¿™ä¸¤ä¸ª<code>onFulfilled</code>å’Œ<code>onRejected</code>æ˜¯å¯é€‰çš„å‚æ•°ï¼š</p>
<ul>
<li>å¦‚æœ <code>onFulfilled</code> ä¸æ˜¯å‡½æ•°ï¼Œåˆ™å¿…é¡»å°†å…¶å¿½ç•¥ã€‚</li>
<li>å¦‚æœ <code>onRejected</code> ä¸æ˜¯å‡½æ•°ï¼Œåˆ™å¿…é¡»å°†å…¶å¿½ç•¥ã€‚</li>
</ul>
</li>
<li><p>å¦‚æœ <code>onFulfilled</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨ <code>promise æ‰§è¡Œç»“æŸåè°ƒç”¨ï¼Œä»¥</code>promise` çš„ç»“æœä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚</li>
<li>åœ¨ <code>promise</code> æ‰§è¡Œç»“æŸä¹‹å‰ä¸èƒ½è°ƒç”¨å®ƒã€‚</li>
<li>ä¸èƒ½å¤šæ¬¡è°ƒç”¨ã€‚</li>
</ul>
</li>
<li><p>å¦‚æœ <code>onRejected</code> æ˜¯ä¸€ä¸ªå‡½æ•°:</p>
<ul>
<li>å¿…é¡»åœ¨ <code>promise</code> è¢«æ‹’ç»ä¹‹åè°ƒç”¨ï¼Œä»¥ <code>promise</code> çš„åŸå› ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚</li>
<li>åœ¨ <code>promise</code> è¢«æ‹’ç»ä¹‹å‰ä¸èƒ½è°ƒç”¨å®ƒã€‚</li>
<li>ä¸èƒ½å¤šæ¬¡è°ƒç”¨ã€‚</li>
</ul>
</li>
<li><p><code>onFulfilled</code> æˆ– <code>onRejected</code> åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡å †æ ˆä»…åŒ…å«å¹³å°ä»£ç ä¹‹å‰ä¸å¾—è°ƒç”¨ã€‚</p>
</li>
<li><p><code>onFulfilled</code> å’Œ <code>onRejected</code> å¿…é¡»ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨ï¼ˆå³æ²¡æœ‰ this å€¼ï¼‰ï¼ˆéå®ä¾‹åŒ–è°ƒç”¨ï¼Œ<code>this</code> åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŒ‡å‘ <code>window</code>ï¼‰ã€‚</p>
</li>
<li><p>then å¯èƒ½åœ¨åŒä¸€ promise ä¸­å¤šæ¬¡è¢«è°ƒç”¨ã€‚</p>
<ul>
<li>å½“ <code>promise</code> å®Œæˆæ—¶ï¼Œåˆ™æ‰€æœ‰ç›¸åº”çš„ <code>onFulfilled</code> å¿…é¡»æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºæ‰§è¡Œ <code>then</code>ã€‚</li>
<li>å½“ <code>promise</code> è¢«æ‹’ç»æ—¶ï¼Œåˆ™æ‰€æœ‰ç›¸åº”çš„ <code>onRejected</code> å¿…é¡»æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºæ‰§è¡Œ <code>then</code>ã€‚<blockquote>
<p>promise2 = promise1.then(onFulfilled, onRejected);</p>
</blockquote>
</li>
</ul>
</li>
<li><p><code>then</code> å¿…é¡»è¿”å› <code>promise</code>ã€‚</p>
<ul>
<li>å¦‚æœæœ‰ä¸€ä¸ª <code>onFulfilled</code> æˆ– <code>onRejected</code> è¿”å›ä¸€ä¸ªå€¼ xï¼Œ<code>promise2</code> è¿›å…¥ <code>onFulfilled</code> çŠ¶æ€ã€‚[1]</li>
<li>å¦‚æœä»»ä½•ä¸€ä¸ª <code>onFulfilled</code> æˆ– <code>onRejected</code> å¼•å‘ä¸€ä¸ªå¼‚å¸¸ eï¼Œåˆ™ <code>promise2</code> å¿…é¡»æ‹’ç» e å¹¶è¿”å›æ‹’ç»åŸå› ã€‚[2]</li>
<li>å¦‚æœ<code>onFulfilled</code> ä¸æ˜¯å‡½æ•°ä¸” <code>promise1</code> å·²å®Œæˆï¼Œåˆ™ <code>promise2</code> å¿…é¡»ä½¿ç”¨ç›¸åŒçš„å€¼æ¥å®Œæˆ <code>promise1</code>ï¼ˆæˆåŠŸï¼‰ã€‚[3]</li>
<li>å¦‚æœ <code>onRejected</code> ä¸æ˜¯å‡½æ•°è€Œ <code>promise1</code> è¢«æ‹’ç»ï¼Œåˆ™ <code>promise2</code> å¿…é¡»ä»¥ä¸ç›¸åŒçš„ç†ç”±å°†å…¶æ‹’ç»ï¼ˆå¤±è´¥ï¼‰ã€‚[4]</li>
</ul>
</li>
</ul>
<p><strong>ï¼ˆæ¯ä¸€ä¸ª <code>promise</code> åªå–å†³äºä¸Šä¸€ä¸ª <code>promise</code> çš„ç»“æœï¼‰</strong></p>
<h5 id="å¯¹ç…§ä¸Šé¢å››æ¡æ ‡å‡†ï¼Œè¿™ä¸ªåœ°æ–¹ä¸¾å‡ ä¸ª-ğŸŒ°-æ¥çœ‹ä¸€ä¸‹-promise-çš„è¾“å‡ºï¼šï¼ˆåˆ¤æ–­ä¸€ä¸‹ä»¥ä¸‹å‡ ç§æƒ…å†µåˆ†åˆ«è¾“å‡ºä»€ä¹ˆï¼Ÿï¼‰"><a href="#å¯¹ç…§ä¸Šé¢å››æ¡æ ‡å‡†ï¼Œè¿™ä¸ªåœ°æ–¹ä¸¾å‡ ä¸ª-ğŸŒ°-æ¥çœ‹ä¸€ä¸‹-promise-çš„è¾“å‡ºï¼šï¼ˆåˆ¤æ–­ä¸€ä¸‹ä»¥ä¸‹å‡ ç§æƒ…å†µåˆ†åˆ«è¾“å‡ºä»€ä¹ˆï¼Ÿï¼‰" class="headerlink" title="å¯¹ç…§ä¸Šé¢å››æ¡æ ‡å‡†ï¼Œè¿™ä¸ªåœ°æ–¹ä¸¾å‡ ä¸ª ğŸŒ° æ¥çœ‹ä¸€ä¸‹ promise çš„è¾“å‡ºï¼šï¼ˆåˆ¤æ–­ä¸€ä¸‹ä»¥ä¸‹å‡ ç§æƒ…å†µåˆ†åˆ«è¾“å‡ºä»€ä¹ˆï¼Ÿï¼‰"></a>å¯¹ç…§ä¸Šé¢å››æ¡æ ‡å‡†ï¼Œè¿™ä¸ªåœ°æ–¹ä¸¾å‡ ä¸ª ğŸŒ° æ¥çœ‹ä¸€ä¸‹ promise çš„è¾“å‡ºï¼šï¼ˆåˆ¤æ–­ä¸€ä¸‹ä»¥ä¸‹å‡ ç§æƒ…å†µåˆ†åˆ«è¾“å‡ºä»€ä¹ˆï¼Ÿï¼‰</h5><p><strong>ï¼ˆ1ï¼‰</strong></p>
<pre><code class="hljs javascript"><span class="hljs-keyword">const</span> promise1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;
    reject()
&#125;)
promise1
    .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-number">123</span>;
    &#125;, <span class="hljs-literal">null</span>)
    .then(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>)
    .then(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>)
    .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'success promise'</span>)
    &#125;, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'error promise'</span>)
    &#125;)</code></pre>


<p>è¾“å‡º<code>error promise</code></p>
<p>é¦–å…ˆ<code>promise1</code>è¿›å…¥<code>onRejected</code>çŠ¶æ€ï¼Œè¿”å›çš„å€¼ä¸º<code>null</code>ï¼Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå‚ç…§ä¸Šæ–¹ç¬¬[4]æ¡ï¼Œä¸åœå‘ä¸‹<code>onRejected</code>ç›´åˆ°<code>console.log(&#39;error promise&#39;)</code><br><strong>ï¼ˆ2ï¼‰</strong></p>
<pre><code class="hljs javascript"><span class="hljs-keyword">const</span> promise1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;
   reject()
&#125;)
promise1
    .then(<span class="hljs-literal">null</span>,<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-number">456</span>;
    &#125;)
    .then(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>)
    .then(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>)
    .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'success promise'</span>)
    &#125;, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'error promise'</span>)
    &#125;)</code></pre>


<p>è¾“å‡º<code>success promise</code></p>
<p>é¦–å…ˆ<code>promise1</code>è¿›å…¥<code>onRejected</code>çŠ¶æ€ï¼Œå‡½æ•°è¿”å›ä¸€ä¸ªå€¼ä¸º 456ï¼Œå‚ç…§ä¸Šæ–¹ç¬¬[1]æ¡ï¼Œæ­¤æ—¶<code>promise2</code>è¿›å…¥ <code>onFulfilled</code> çŠ¶æ€ï¼Œå‚ç…§ä¸Šæ–¹ç¬¬[4]æ¡ï¼Œä¸åœå‘ä¸‹å®Œæˆç›´åˆ°<code>console.log(&#39;success promise&#39;)</code></p>
<p><strong>ï¼ˆ3ï¼‰</strong></p>
<pre><code class="hljs javascript"><span class="hljs-keyword">const</span> promise1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;
    resolve()
&#125;)
promise1
    .then(<span class="hljs-literal">null</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-number">456</span>;
    &#125;)
    .then(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>)
    .then(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>)
    .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'e'</span>)
    &#125;, <span class="hljs-literal">null</span>)
    .then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'success promise'</span>)
    &#125;, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'error promise'</span>)
    &#125;)</code></pre>


<p>è¾“å‡º<code>error promise</code></p>
<p>é¦–å…ˆ<code>promise1</code>è¿›å…¥<code>onFulfilled</code>çŠ¶æ€ï¼Œè¿”å›<code>null</code>ï¼Œå‚ç…§ä¸Šæ–¹ç¬¬[4]æ¡ï¼Œä¸åœå‘ä¸‹å®Œæˆç›´åˆ°æŠ›å‡ºå¼‚å¸¸<code>e</code>ï¼Œå‚ç…§ä¸Šæ–¹ç¬¬[2]æ¡ï¼Œæ­¤æ—¶è¿›å…¥<code>onRejected</code>çŠ¶æ€ï¼Œå‘ä¸‹è¾“å‡º<code>console.log(&#39;success promise&#39;)</code></p>
<h5 id="promise-è§£å†³è¿‡ç¨‹"><a href="#promise-è§£å†³è¿‡ç¨‹" class="headerlink" title="promise è§£å†³è¿‡ç¨‹"></a>promise è§£å†³è¿‡ç¨‹</h5><p><code>promise</code> è§£å†³è¿‡ç¨‹æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ“ä½œï¼Œè¾“å…¥ä¸€ä¸ª <code>promise</code> å’Œä¸€ä¸ªå€¼ï¼Œå®ƒè¡¨ç¤ºä¸º<code>[[Resolve]](promise, x)</code>ã€‚å¦‚æœ x æ˜¯ <code>thenable</code> çš„ï¼Œåˆ™å…¶è¡Œä¸ºç±»ä¼¼äº <code>promise</code>ï¼Œå°è¯•ä½¿ <code>promise</code> é‡‡ç”¨ x çš„çŠ¶æ€ã€‚å¦åˆ™ï¼Œå®ƒå°†ä½¿ç”¨ <code>value</code>ã€‚</p>
<p>åªè¦å¯¹çº¦å®šçš„å®ç°å…¬å¼€ <code>Promises / A +</code>å…¼å®¹çš„ <code>then</code> æ–¹æ³•ï¼Œå¯¹çº¦å®šçš„å®ç°å°±å¯ä»¥è¿›è¡Œäº’æ“ä½œã€‚å®ƒè¿˜å…è®¸<code>Promises / A +</code>å®ç°ä»¥åˆç†çš„ <code>then</code> æ–¹æ³•â€œåŒåŒ–â€ä¸åˆæ ¼çš„å®ç°ã€‚<br>è¦è¿è¡Œ<code>[[Resolve]](promise, x)</code>ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ul>
<li>å¦‚æœ <code>promise</code> å’Œ <code>x</code> å¼•ç”¨ç›¸åŒçš„å¯¹è±¡ï¼Œåˆ™ä»¥ <code>TypeError</code> ä¸ºç†ç”±æ‹’ç»<code>promise</code>ã€‚</li>
<li>å¦‚æœ <code>x</code> æ˜¯ä¸€ä¸ª <code>promise</code>ï¼Œåˆ™é‡‡ç”¨å…¶çŠ¶æ€ï¼š<ul>
<li>å¦‚æœ <code>x</code> ç­‰å¾…ä¸­ï¼Œåˆ™ <code>promise</code> å¿…é¡»ä¿æŒç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ° <code>x</code> å·²å®Œæˆæˆ–å·²æ‹’ç»ã€‚[1]</li>
<li>å¦‚æœ <code>x</code> å·²å®Œæˆï¼Œ<code>promise</code> åˆ™ä»¥ç›¸åŒçš„å€¼å®Œæˆã€‚[2]</li>
<li>å¦‚æœ <code>x</code> å·²æ‹’ç»ï¼Œ<code>promise</code> åˆ™ä»¥ç›¸åŒçš„ç†ç”±æ‹’ç»ã€‚[3]<strong>ï¼ˆ.then()çš„çŠ¶æ€å–å†³äºè¿”å›çš„ promise çš„çŠ¶æ€ï¼‰</strong></li>
</ul>
</li>
</ul>
<h5 id="å†ä¸¾ä¸ª-ğŸŒ°"><a href="#å†ä¸¾ä¸ª-ğŸŒ°" class="headerlink" title="å†ä¸¾ä¸ª ğŸŒ°"></a>å†ä¸¾ä¸ª ğŸŒ°</h5><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> promise1 =<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolve,reject</span>)</span>&#123;
    resolve(<span class="hljs-string">'promise1'</span>)
&#125;)
<span class="hljs-keyword">var</span> promise2 =<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolve,reject</span>)</span>&#123;
    resolve(<span class="hljs-string">'promise2'</span>)
&#125;)
promise1.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>)</span>&#123;
    <span class="hljs-keyword">return</span> promise2
&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>)</span>&#123;
    <span class="hljs-built_in">console</span>.log(val)
&#125;)</code></pre>


<p>è¾“å‡º<code>promise2</code>ï¼Œå‚ç…§ä¸Šæ–¹ç¬¬[2]æ¡</p>
<ul>
<li>å¦åˆ™ï¼Œå¦‚æœ <code>x</code> æ˜¯å¯¹è±¡æˆ–å‡½æ•°ï¼ˆä¸å¤ªå¸¸è§ï¼‰<ul>
<li>å…ˆæ‰§è¡Œ <code>x.then</code>ã€‚</li>
<li>å¦‚æœå– <code>x.then</code> ä¸­å€¼æ—¶æŠ›å‡ºå¼‚å¸¸çš„ç»“æœ eï¼Œä»¥ e ä½œä¸ºåŸå› æ‹’ç» <code>promise</code>ã€‚</li>
<li>å¦‚æœ <code>then</code> æ˜¯å‡½æ•°ï¼Œè¯·ä½¿ç”¨ <code>x</code> ä½œä¸º <code>this</code>ï¼Œç¬¬ä¸€ä¸ªå‚æ•° <code>resolvePromise</code> å’Œç¬¬äºŒä¸ªå‚æ•° <code>rejectPromise</code> è¿›è¡Œè°ƒç”¨ï¼Œå…¶ä¸­ï¼š<ul>
<li>å¦‚æœ <code>resolvePromise</code> è°ƒç”¨ <code>y</code> ä½œä¸ºå€¼ï¼Œè¯·è¿è¡Œ<code>[[Resolve]](promise, y)</code>ã€‚</li>
<li>å¦‚æœ <code>rejectPromise</code> è°ƒç”¨ <code>r</code> ä½œä¸ºæ‹’å› ï¼Œä»¥ <code>r</code> ä½œä¸ºåŸå› æ‹’ç» <code>promise</code>ã€‚</li>
<li>å¦‚æœåŒæ—¶è°ƒç”¨ <code>resolvePromise</code> å’Œ <code>rejectPromise</code>ï¼Œæˆ–è€…å¯¹åŒä¸€ä¸ªå‚æ•°è¿›è¡Œäº†å¤šæ¬¡è°ƒç”¨ï¼Œåˆ™ç¬¬ä¸€ä¸ªè°ƒç”¨ä¼˜å…ˆï¼Œå…¶ä»–ä»»ä½•è°ƒç”¨éƒ½å°†è¢«å¿½ç•¥ã€‚</li>
<li>å¦‚æœè°ƒç”¨ <code>then</code> å¼•å‘å¼‚å¸¸ <code>e</code>ï¼Œ<ul>
<li>å¦‚æœ <code>resolvePromise</code>æˆ– <code>rejectPromise</code> å·²ç»è¢«è°ƒç”¨ï¼Œåˆ™å¿½ç•¥å®ƒã€‚</li>
<li>å¦åˆ™ï¼Œä»¥ <code>e</code> ä½œä¸ºåŸå› æ‹’ç» <code>promise</code>ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>å¦‚æœ <code>then</code> ä¸æ˜¯å‡½æ•°ï¼Œ<code>promise</code> è°ƒç”¨ <code>x</code> å˜ä¸ºå·²å®ŒæˆçŠ¶æ€ã€‚</li>
</ul>
</li>
<li>å¦‚æœ <code>x</code> ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å‡½æ•°ï¼Œ<code>promise</code> è°ƒç”¨ <code>x</code> å˜ä¸ºå·²å®ŒæˆçŠ¶æ€ï¼ˆå¸¸è§ï¼‰ã€‚</li>
</ul>
<h5 id="åˆæ¥ä¸€ä¸ª-ğŸŒ°"><a href="#åˆæ¥ä¸€ä¸ª-ğŸŒ°" class="headerlink" title="åˆæ¥ä¸€ä¸ª ğŸŒ°"></a>åˆæ¥ä¸€ä¸ª ğŸŒ°</h5><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> promise1 =<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolve,reject</span>)</span>&#123;
    resolve(<span class="hljs-string">'promise1'</span>)
&#125;)
<span class="hljs-keyword">var</span> promise2 =<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolve,reject</span>)</span>&#123;
    resolve(<span class="hljs-string">'promise2'</span>)
&#125;)
promise1.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>)</span>&#123;
    <span class="hljs-keyword">return</span> val
&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val</span>)</span>&#123;
    <span class="hljs-built_in">console</span>.log(val)
&#125;)</code></pre>


<p>è¾“å‡º<code>promise1</code>ï¼Œ<code>x</code>ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–å‡½æ•°</p>
<p>å¦‚æœä½¿ç”¨åœ¨ä¸€ä¸ªå¾ªç¯é“¾ä¸­çš„ <code>thenable</code> æ¥è§£å†³ <code>promise</code>ï¼Œ<code>[[Resolve]](promise, thenable)</code>ä¼šå¯¼è‡´é€’å½’ï¼Œ<code>[[Resolve]](promise, thenable)</code>å°†è¢«å†æ¬¡è°ƒç”¨ï¼Œä»¥ä¸Šä¼šå¯¼è‡´æ— é™é€’å½’ã€‚æ¨èï¼ˆä½†ä¸æ˜¯å¿…éœ€ï¼‰ï¼Œæ£€æµ‹è¿™ç§é€’å½’å¹¶ä»¥<code>TypeError</code> ä¸ºç†ç”±æ‹’ç» <code>promise</code>ã€‚</p>
<h3 id="æ‰‹å†™ä¸€ä¸ªPromise"><a href="#æ‰‹å†™ä¸€ä¸ªPromise" class="headerlink" title="æ‰‹å†™ä¸€ä¸ªPromise"></a>æ‰‹å†™ä¸€ä¸ªPromise</h3><p>æ ¹æ®promiseA+å®ç°ä¸€ä¸ªè‡ªå·±çš„promiseï¼Œè¿™é‡Œä¸å¤šè®²è§£äº†ï¼Œæ–‡æœ«ä¼šæ¨èå‡ ç¯‡è‡ªå·±è§‰å¾—æ¯”è¾ƒå¥½çš„æ–‡ç« </p>
<p>ï¼ˆå…¶å®æ˜¯æˆ‘è‡ªå·±åœ¨å†™çš„è¿˜æ²¡å®Œå–„å¥½ï¼Œç­‰å†™æ»¡æ„äº†å†å›æ¥è¡¥å‘ï¼‰</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/png/1542493/1593049540238-f5ac61fc-eacb-4e02-aa61-3d8d0aeffcd7.png#align=left&display=inline&height=119&margin=%5Bobject%20Object%5D&originHeight=119&originWidth=126&size=0&status=done&style=none&width=126" srcset="/img/loading.gif" alt=""></p>
<h3 id="ä»‹ç»å‡ ä¸ªPromiseå¸¸ç”¨çš„æ–¹æ³•"><a href="#ä»‹ç»å‡ ä¸ªPromiseå¸¸ç”¨çš„æ–¹æ³•" class="headerlink" title="ä»‹ç»å‡ ä¸ªPromiseå¸¸ç”¨çš„æ–¹æ³•"></a>ä»‹ç»å‡ ä¸ªPromiseå¸¸ç”¨çš„æ–¹æ³•</h3><h4 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all"></a>Promise.all</h4><p>è°è·‘çš„æ…¢ï¼Œä»¥è°ä¸ºå‡†æ‰§è¡Œå›è°ƒã€‚allæ¥æ”¶ä¸€ä¸ªæ•°ç»„å‚æ•°ï¼Œé‡Œé¢çš„å€¼æœ€ç»ˆéƒ½ç®—è¿”å›Promiseå¯¹è±¡</p>
<p>å¹¶è¡Œæ‰§è¡Œå¼‚æ­¥æ“ä½œçš„èƒ½åŠ›ï¼ˆæ²¡æœ‰é¡ºåºï¼‰ï¼Œå¹¶ä¸”åœ¨æ‰€æœ‰å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œåæ‰æ‰§è¡Œå›è°ƒã€‚</p>
<pre><code class="hljs javascript"><span class="hljs-keyword">const</span> promise = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">time</span>) </span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;
        <span class="hljs-keyword">return</span> setTimeout(resolve(time), time);
    &#125;)
&#125;
<span class="hljs-built_in">Promise</span>.all([promise(<span class="hljs-number">1000</span>), promise(<span class="hljs-number">3000</span>)]).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">values</span>) </span>&#123;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'all'</span>, values.toString()) <span class="hljs-comment">// ä¸‰ä¸ªéƒ½æˆåŠŸåˆ™æˆåŠŸ </span>
&#125;,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>&#123;
    <span class="hljs-built_in">console</span>.log(e) <span class="hljs-comment">// åªè¦æœ‰å¤±è´¥ï¼Œåˆ™å¤±è´¥ </span>
&#125;)</code></pre>


<p>3ç§’åè¾“å‡º <code>all 1000,3000</code></p>
<h4 id="Promise-race"><a href="#Promise-race" class="headerlink" title="Promise.race"></a>Promise.race</h4><p>è°è·‘çš„å¿«ï¼Œä»¥è°ä¸ºå‡†æ‰§è¡Œå›è°ƒã€‚</p>
<pre><code class="hljs javascript"><span class="hljs-keyword">const</span> promise = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">time</span>) </span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;
        <span class="hljs-keyword">return</span> setTimeout(resolve(time), time);
    &#125;)
&#125;
<span class="hljs-built_in">Promise</span>.race([promise(<span class="hljs-number">1000</span>),promise(<span class="hljs-number">3000</span>)]).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>)</span>&#123;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'race'</span>,value)
&#125;)</code></pre>


<p>1ç§’åè¾“å‡º <code>race 1000</code></p>
<p>å¯ä»¥ç”¨raceç»™æŸä¸ªå¼‚æ­¥è¯·æ±‚è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¹¶ä¸”åœ¨è¶…æ—¶åæ‰§è¡Œç›¸åº”çš„æ“ä½œ</p>
<pre><code class="hljs javascript"><span class="hljs-comment">//è¯·æ±‚æŸä¸ªå›¾ç‰‡èµ„æº</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestImg</span>(<span class="hljs-params"></span>)</span>&#123;
    <span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;
        <span class="hljs-keyword">var</span> img = <span class="hljs-keyword">new</span> Image();
        img.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;
            resolve(img);
        &#125;
        img.src = <span class="hljs-string">'å›¾ç‰‡çš„è·¯å¾„'</span>;
    &#125;);
    <span class="hljs-keyword">return</span> p;
&#125;
<span class="hljs-comment">//å»¶æ—¶å‡½æ•°ï¼Œç”¨äºç»™è¯·æ±‚è®¡æ—¶</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timeout</span>(<span class="hljs-params"></span>)</span>&#123;
    <span class="hljs-keyword">var</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;
        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;
            reject(<span class="hljs-string">'å›¾ç‰‡è¯·æ±‚è¶…æ—¶'</span>);
        &#125;, <span class="hljs-number">5000</span>);
    &#125;);
    <span class="hljs-keyword">return</span> p;
&#125;
<span class="hljs-built_in">Promise</span>.race([requestImg(), timeout()]).then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span>&#123;
    <span class="hljs-built_in">console</span>.log(data);
&#125;).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;
    <span class="hljs-built_in">console</span>.log(err);
&#125;);</code></pre>


<h3 id="å·¨äººçš„è‚©è†€ï¼ˆåŒ…æ‹¬è®¤ä¸ºæ¯”è¾ƒå¥½çš„æ‰‹å†™Promiseæ–‡ç« ï¼‰"><a href="#å·¨äººçš„è‚©è†€ï¼ˆåŒ…æ‹¬è®¤ä¸ºæ¯”è¾ƒå¥½çš„æ‰‹å†™Promiseæ–‡ç« ï¼‰" class="headerlink" title="å·¨äººçš„è‚©è†€ï¼ˆåŒ…æ‹¬è®¤ä¸ºæ¯”è¾ƒå¥½çš„æ‰‹å†™Promiseæ–‡ç« ï¼‰"></a>å·¨äººçš„è‚©è†€ï¼ˆåŒ…æ‹¬è®¤ä¸ºæ¯”è¾ƒå¥½çš„æ‰‹å†™Promiseæ–‡ç« ï¼‰</h3><ul>
<li><a href="https://juejin.im/post/5afe6d3bf265da0b9e654c4b" target="_blank" rel="noopener">Promiseä¸ä¼šï¼Ÿï¼Ÿçœ‹è¿™é‡Œï¼ï¼ï¼å²ä¸Šæœ€é€šä¿—æ˜“æ‡‚çš„Promiseï¼ï¼ï¼</a></li>
<li><a href="https://juejin.im/post/5b16800fe51d4506ae719bae#heading-30" target="_blank" rel="noopener">ä¸€èµ·å­¦ä¹ é€ è½®å­ï¼ˆä¸€ï¼‰ï¼šä»é›¶å¼€å§‹å†™ä¸€ä¸ªç¬¦åˆPromises/A+è§„èŒƒçš„promise</a></li>
<li><a href="https://mp.weixin.qq.com/s/qdJ0Xd8zTgtetFdlJL3P1g" target="_blank" rel="noopener">100 è¡Œä»£ç å®ç° Promises/A+ è§„èŒƒ</a></li>
<li><a href="https://juejin.im/post/5b83cb5ae51d4538cc3ec354" target="_blank" rel="noopener">Promiseå®ç°åŸç†ï¼ˆé™„æºç ï¼‰</a></li>
<li><a href="https://juejin.im/post/5a04066351882517c416715d" target="_blank" rel="noopener">Promise å¿…çŸ¥å¿…ä¼šï¼ˆåé“é¢˜ï¼‰</a></li>
<li><a href="https://juejin.im/post/5b2f02cd5188252b937548ab#heading-9" target="_blank" rel="noopener">BATå‰ç«¯ç»å…¸é¢è¯•é—®é¢˜ï¼šå²ä¸Šæœ€æœ€æœ€è¯¦ç»†çš„æ‰‹å†™Promiseæ•™ç¨‹</a></li>
</ul>
<h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a><strong>æœ€å</strong></h3><p>æ¬¢è¿çº é”™ï¼Œçœ‹åˆ°ä¼šåŠæ—¶ä¿®æ”¹å“’ï¼â¤<br>æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œå¸Œæœ›æˆ‘ä»¬éƒ½å¯ä»¥ä¿æŒæœ¬å¿ƒï¼Œå¿µå¿µä¸å¿˜ï¼Œå¿…æœ‰å›å“ã€‚</p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E6%8A%80%E6%9C%AFblog/">æŠ€æœ¯blog</a>
                    
                      <a class="hover-with-bg" href="/categories/%E6%8A%80%E6%9C%AFblog/ES6/">ES6</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/ES6/">ES6</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/07/14/technology/js-basic2/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ä»å¤´æ¢³ç†JSåŸºç¡€ï¼ˆäºŒï¼‰å‡½æ•°æ‰§è¡Œçš„æ•´ä¸ªè¿‡ç¨‹</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/06/08/technology/vue-provider/">
                        <span class="hidden-mobile">vueç»„ä»¶é€šä¿¡--provide/inject</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  
    <!-- APlayer éŸ³ä¹æ’­æ”¾å™¨ -->
    <div id="aplayer"></div>
    <script defer src="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.js" ></script>
<link  rel="stylesheet" href="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.css" />
<script type="text/javascript">
  var oldLoadAp = window.onload;
  window.onload = function () {
    oldLoadAp && oldLoadAp();

    new APlayer({
      container: document.getElementById('aplayer'),
      fixed: true,
      autoplay: 'false' === 'true',
      loop: 'all',
      order: 'random',
      theme: '#b7daff',
      preload: 'none',
      audio: [{"name":"æµ·åº•","artist":"ä¸‰å—æœ¨å¤´","url":"/songs/ä¸‰å—æœ¨å¤´ - æµ·åº•.mp3","cover":"/img/cover.png"},{"name":"ãƒãƒ¬ãƒãƒ¬ãƒ¤ï¼ˆæœ—æœ—æ™´å¤©ï¼‰","artist":"çŒ«ç‘¾","url":"/songs/çŒ«ç‘¾ - ãƒãƒ¬ãƒãƒ¬ãƒ¤ï¼ˆæœ—æœ—æ™´å¤©ï¼‰.mp3","cover":"/img/cover.png"},{"name":"ã¼ãã‚‰ï¼ˆåŸé•‡é’å¹´EDï¼‰","artist":"ç–è‚†ä»Ÿ","url":"/songs/ç–è‚†ä»Ÿ - ã¼ãã‚‰ï¼ˆåŸé•‡é’å¹´EDï¼‰.mp3","cover":"/img/cover.png"}]
    });
  }
</script>

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <span>&</span>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
      <i class="iconfont icon-love"></i>
      <span>by èŠ‹å¤´</span>
      <!-- <span id="hitokoto">:D è·å–ä¸­...</span> -->
    </div>
    <div>
      <span id="timeDate">è½½å…¥å¤©æ•°...</span>
      <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
    </div>
    
  <div class="statistics">
    
    

    
      
        <!-- ä¸è’œå­ç»Ÿè®¡PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="busuanzi_value_site_pv"></span>
             æ¬¡
          </span>
      
      
        <!-- ä¸è’œå­ç»Ÿè®¡UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="busuanzi_value_site_uv"></span>
             äºº
          </span>
      
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "ä» Promises/A+ è§„èŒƒç…ä¸€ç… Promise&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>


















<script>
  // fetch('https://v1.hitokoto.cn')
  //   .then(response => response.json())
  //   .then(data => {
  //     const hitokoto = document.getElementById('hitokoto')
  //     hitokoto.innerText = data.hitokoto
  //   })
  //   .catch(console.error)
  var now = new Date();
  function createtime() {
    var grt = new Date("07/28/2020 00:00:00");//æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
    now.setTime(now.getTime() + 250);
    days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
    document.getElementById("timeDate").innerHTML = "æŒ‰æ—¶é•¿å¤§çš„ç¬¬&nbsp" + dnum + "&nbspå¤©";
    document.getElementById("times").innerHTML = hnum + "&nbspå°æ—¶&nbsp" + mnum + "&nbspåˆ†&nbsp" + snum + "&nbspç§’";
  }
  setInterval("createtime()", 250);
</script>

</body>
</html>
